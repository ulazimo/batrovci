<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prototype Ideas - Mladen's Lab</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Rajdhani', 'sans-serif'],
                        display: ['Orbitron', 'sans-serif'],
                    },
                    colors: {
                        cyber: {
                            bg: '#0B0E14',
                            card: '#151923',
                            border: '#2A303C',
                            primary: '#00F0FF',
                            secondary: '#7000FF',
                            text: '#E0E6ED',
                            muted: '#94A3B8'
                        }
                    },
                    backgroundImage: {
                        'grid-pattern': "linear-gradient(to right, rgba(42, 48, 60, 0.3) 1px, transparent 1px), linear-gradient(to bottom, rgba(42, 48, 60, 0.3) 1px, transparent 1px)",
                    }
                }
            }
        }
    </script>
    <style>
        body { background-color: #0B0E14; }
        .bg-grid { background-size: 40px 40px; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0B0E14; }
        ::-webkit-scrollbar-thumb { background: #2A303C; border-radius: 0px; }
        ::-webkit-scrollbar-thumb:hover { background: #00F0FF; }
        .neon-text { text-shadow: 0 0 10px rgba(0, 240, 255, 0.5); }
    </style>
</head>
<body class="text-cyber-text min-h-screen flex flex-col font-sans antialiased overflow-x-hidden">
    
    <div class="fixed inset-0 bg-grid-pattern bg-grid pointer-events-none z-0"></div>

    <!-- Header -->
    <header class="border-b border-cyber-border bg-cyber-bg/90 backdrop-blur-md sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-20 flex items-center justify-between">
            <a href="index.html" class="flex items-center gap-3">
                <div class="relative">
                    <div class="absolute -inset-1 bg-cyber-primary rounded-full blur opacity-25"></div>
                    <i data-lucide="gamepad-2" class="text-cyber-primary w-8 h-8 relative z-10"></i>
                </div>
                <div class="flex flex-col">
                    <h1 class="text-xl font-display font-bold tracking-wider text-white uppercase neon-text">
                        Mladen Dulanovic
                    </h1>
                    <span class="text-xs text-cyber-primary font-mono tracking-[0.2em] uppercase">Prototype Lab</span>
                </div>
            </a>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 w-full relative z-10">
        <h2 class="text-4xl md:text-5xl font-display font-bold text-white mb-8 text-center neon-text">
            Prototype <span class="text-cyber-primary">Ideas</span>
        </h2>

        <!-- Ideas List -->
        <div id="ideas-list" class="space-y-6 mb-16">
            <!-- Ideas will be loaded from Firebase here -->
        </div>

        <!-- Submission Form -->
        <div id="submit-form" class="bg-cyber-card/70 border border-cyber-border rounded-lg p-8 pt-4 max-w-4xl mx-auto">
            <div class="text-center mb-6">
                <h3 class="text-3xl font-display font-bold text-white mb-2">Submit a New Idea</h3>
                <div class="h-1 w-24 bg-cyber-primary mx-auto"></div>
            </div>
            <form id="idea-form" class="space-y-6">
                <div>
                    <label for="idea-title" class="block text-sm font-mono text-cyber-primary mb-2">Idea Title</label>
                    <input type="text" id="idea-title" name="title" class="block w-full px-4 py-3 bg-cyber-bg border border-cyber-border placeholder-cyber-muted/50 focus:outline-none focus:border-cyber-primary transition-colors" placeholder="e.g., Real-time weather integration">
                </div>
                <div>
                    <label for="idea-description" class="block text-sm font-mono text-cyber-primary mb-2">Description</label>
                    <textarea id="idea-description" name="description" rows="4" class="block w-full px-4 py-3 bg-cyber-bg border border-cyber-border placeholder-cyber-muted/50 focus:outline-none focus:border-cyber-primary transition-colors" placeholder="Explain the core mechanic or concept..."></textarea>
                </div>
                <div class="text-center pt-4">
                    <button type="submit" class="inline-block px-10 py-4 bg-cyber-primary text-cyber-bg font-display font-bold text-lg uppercase tracking-wider hover:bg-white hover:shadow-[0_0_25px_rgba(0,240,255,0.7)] transition-all duration-300" style="clip-path: polygon(10% 0, 100% 0, 100% 70%, 90% 100%, 0 100%, 0 30%);">
                        SUBMIT
                    </button>
                </div>
            </form>
        </div>
    </main>

    <!-- Footer -->
    <footer class="border-t border-cyber-border bg-cyber-bg z-10 relative">
        <div class="max-w-7xl mx-auto px-4 py-8 sm:px-6 lg:px-8 text-center">
            <p class="text-sm text-cyber-muted font-mono">
                &copy; <span id="year"></span> Mladen Dulanovic // PROTOTYPE_DIRECTORY
            </p>
        </div>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, getDocs, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyC2RSC711FagoP5XsODIFfLMMZUX6Up-xM",
            authDomain: "prototypes-7691b.firebaseapp.com",
            projectId: "prototypes-7691b",
            storageBucket: "prototypes-7691b.firebasestorage.app",
            messagingSenderId: "263652926534",
            appId: "1:263652926534:web:9af3c4ce63aab78f0f9647",
            measurementId: "G-1X91H99N2G"
        };
        
        let db;
        try {
            const app = initializeApp(firebaseConfig);
            db = getFirestore(app);
            console.log("Firebase Initialized for Ideas Page");
            loadIdeas();
        } catch(e) {
            console.error("Firebase initialization failed:", e);
        }

        const ideasList = document.getElementById('ideas-list');
        const ideaForm = document.getElementById('idea-form');
        document.getElementById('year').textContent = new Date().getFullYear();
        lucide.createIcons();

        async function loadIdeas() {
            if (!db) return;
            const querySnapshot = await getDocs(collection(db, "ideas"));
            const ideas = [];
            querySnapshot.forEach((doc) => {
                ideas.push({ id: doc.id, ...doc.data() });
            });
            
            // Clear placeholders
            ideasList.innerHTML = ''; 

            ideas.sort((a,b) => (b.timestamp?.toDate() || 0) - (a.timestamp?.toDate() || 0));

            ideas.forEach(idea => {
                const ideaEl = document.createElement('div');
                ideaEl.className = "bg-cyber-card/80 border border-cyber-border p-6 rounded-lg";
                ideaEl.innerHTML = `
                    <h3 class="text-xl font-display font-bold text-white mb-2">${idea.title}</h3>
                    <p class="text-cyber-muted">${idea.description}</p>
                `;
                ideasList.appendChild(ideaEl);
            });
        }

        ideaForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            if (!db) {
                alert("Database not connected. Cannot submit idea.");
                return;
            }

            const title = ideaForm.title.value.trim();
            const description = ideaForm.description.value.trim();

            if (title && description) {
                try {
                    await addDoc(collection(db, "ideas"), {
                        title: title,
                        description: description,
                        timestamp: serverTimestamp()
                    });
                    ideaForm.reset();
                    loadIdeas(); 
                } catch (error) {
                    console.error("Error adding document: ", error);
                    alert("Failed to submit idea. See console for details.");
                }
            } else {
                alert("Please fill out both the title and description.");
            }
        });
    </script>
</body>
</html>
